# Динамическая система квестов

[EN Version]()

Взял за основу UI базу шаблона и алмазики у [asset store](https://act.hoyoverse.com/ys/prod/ugc/component-store/index.html#/item/1997381320145154048).

*PS: скрипты и логику всю написал с нуля, взял только визуал.*

---

## Описание
Система квестов полностью настраиваемая и расширяемая, основанная на структурах.
Чтобы создать квест, нужно добавить 2 переменных в нужном объекте/префабе:
- **Quest** — структура для настройки квеста.
- **QuestActive** — булевое значение для локальных фильтров.

Вызывать квест можно через сигнал **Quest/SwapQuest** в логике уровня. Встраивайте куда угодно и дополняйте их как хотите.

Настройка текста и типа осуществляется в структуре **Quest** у того объекта, куда будет ссылаться сам квест.
*Квесты адаптированы под создание переводов!*

---

## Что нужно сделать после импорта?

1. Создать 8 переменных в сущности уровня и назовите их как в префабе **NQ_QuestPresetVARs** (значения-заглушки нужны! Можно взять оттуда же).
2. Добавить **NQ_MainLogic** в сущность уровня.
3. Добавить **QuestUI** в макет меню и скопировать его индекс.
4. Зайти в составной узел **NQ_QuestUI_Optimization** и вставить индекс в локальную переменную.
5. Проверить, чтобы GUID вашей сущности уровня был верным в составном узле **Level**.
6. Создать переменную для игрока **distanceToQuest** (целое число) и добавить для игрока скрипт **NQ_DistanceToQ** (*НЕ ПЕРСОНАЖУ И НЕ КЛАССУ!*).
7. Для тестовых объектов в мире назначить у **VFX** и **Табличке** локальный фильтр по **NQ_QuestActive**.
8. Проверять и адаптировать под свои задачи.

> **Внимание!**
> Если будете переименовывать переменные в объектах и префабах под себя, переименуйте их и в скриптах!

---

## Префабы и объекты
Префабы созданы для тестирования логики и не нужны после выполнения шагов 1–6.
Объекты настроены для связи друг с другом.

---

## Описание структур

### Quest

Структура Quest


| Поле          | Описание                                                                                     |
|---------------|---------------------------------------------------------------------------------------------|
| Title         | Заголовок квеста.                                                                            |
| Description   | Описание квеста.                                                                             |
| Type          | Индекс типа, по которому формируются иконки, цвета и размеры.                               |
| Next          | GUID объекта, на который поменяется квест после сигнала **SwapQuest**. Если `0`, квест не появится. |
| AllPlayers    | Если `true`, квест будет отображаться в интерфейсе у всех игроков (для кооп-квестов).        |
| QuestEnity    | Самосохранение сущности для логики определения расстояния.                                   |

---

### TypesQuests

Структура TypesQuests


| Поле              | Описание                                                                                     |
|-------------------|---------------------------------------------------------------------------------------------|
| Diamonds          | Задний фон у иконки.                                                                         |
| Glyphs            | Передний план у иконки (символ).                                                            |
| SizeDiamond       | Размер заднего фона.                                                                         |
| SizeGlyph         | Размер текста символа.                                                                      |
| ColorsDiamonds    | Цвет для заднего фона.                                                                      |
| ColorsGlyphs      | Цвет для символа.                                                                            |

> **Примечание:**
> При создании нового типа добавляйте значение в каждый словарь, даже если данные дублируются!